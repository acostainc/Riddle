<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Alex's Riddle App</title>
<meta property="og:title" content="Alex's Riddle App" />
<meta name="twitter:title" content="Alex's Riddle App" />
<meta name="apple-mobile-web-app-title" content="Alex's Riddle App" />
<style>
  .halo, .halo.h2 { pointer-events: none; z-index: 0; }
  header, #start-screen, #quiz, #reveal { position: relative; z-index: 1; }
  /* other existing styles remain unchanged */
</style>
</head>
<body>
<canvas class="confetti-canvas" aria-hidden="true"></canvas>
<main class="wrap">
  <section class="card">
    <div class="halo"></div>
    <div class="halo h2"></div>
    <header>
      <h1 class="title">A Little Riddle Adventure</h1>
      <p class="subtitle">Solve four short riddles to unlock a happy surprise.</p>
    </header>
    <div id="start-screen">
      <p class="riddle">Designed for phones â€¢ Big tap targets â€¢ Warm fuzzies guaranteed ðŸ’›</p>
      <button class="btn" id="start-btn">Start</button>
    </div>
    <div id="quiz" hidden>
      <div class="progress">
        <div class="progress-bar"><div class="progress-fill" id="bar"></div></div>
        <div class="progress-text" id="ptext">1/4</div>
      </div>
      <div class="riddle" id="riddle"></div>
      <form id="form">
        <input id="answer" type="text" required />
        <button class="btn" type="submit">Submit</button>
      </form>
      <div id="hint" class="hint"></div>
    </div>
    <div id="reveal" hidden>
      <h1 id="headline">Weâ€™re having a baby â€” March 2026</h1>
    </div>
  </section>
</main>
<script>
  const RIDDLES = [
    { q: "Iâ€™m taken before you can see me, and kept to remember a moment. What am I?", a: "photo" },
    { q: "I follow you day and night but disappear in the dark. What am I?", a: "shadow" },
    { q: "I speak without a mouth and can be heard but not seen. What am I?", a: "echo" },
    { q: "Small but mighty, Iâ€™m a bundle of joy arriving to make two hearts three. What am I?", a: "baby" }
  ];
  const el = id => document.getElementById(id);
  const stateKey = 'riddle-reveal-v1';
  let state = { i: 0 };
  try {
    const saved = JSON.parse(localStorage.getItem(stateKey));
    if (saved && Number.isInteger(saved.i) && saved.i >= 0 && saved.i < RIDDLES.length) state = saved;
  } catch {}
  const save = () => { try { localStorage.setItem(stateKey, JSON.stringify(state)); } catch {} };
  const setProgress = i => {
    el('bar').style.width = `${(i / RIDDLES.length) * 100}%`;
    el('ptext').textContent = `${i+1}/${RIDDLES.length}`;
  };
  const showRiddle = i => {
    if (!Number.isInteger(i) || i < 0 || i >= RIDDLES.length) i = 0;
    el('quiz').hidden = false;
    el('start-screen').hidden = true;
    el('reveal').hidden = true;
    setProgress(i);
    el('riddle').textContent = RIDDLES[i].q;
    el('answer').value = '';
    el('hint').textContent = '';
    save();
    el('answer').focus();
  };
  const showReveal = () => {
    el('quiz').hidden = true;
    el('start-screen').hidden = true;
    el('reveal').hidden = false;
    save();
  };
  const startBtn = el('start-btn');
  if (startBtn) {
    startBtn.addEventListener('click', () => { state.i = 0; save(); showRiddle(0); });
    startBtn.addEventListener('touchstart', e => { e.preventDefault(); startBtn.click(); }, { passive: false });
  }
  el('form').addEventListener('submit', e => {
    e.preventDefault();
    const val = el('answer').value.trim().toLowerCase();
    if (val === RIDDLES[state.i].a) {
      state.i++;
      if (state.i >= RIDDLES.length) showReveal(); else showRiddle(state.i);
    } else {
      el('hint').textContent = 'Not quite â€” try again!';
    }
  });
  if (state.i > 0 && state.i < RIDDLES.length) showRiddle(state.i);
  if (state.i >= RIDDLES.length) showReveal();
</script>
</body>
</html>
